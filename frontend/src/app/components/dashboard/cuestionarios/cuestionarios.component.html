<div class="cuestionarios-container">
  <div class="page-header">
    <h1 class="page-title">Cuestionario de Factores de Riesgo Psicosocial</h1>
    <button class="create-btn" (click)="reiniciarCuestionarios()" *ngIf="todosCompletados">
      <i class="fas fa-sync-alt"></i> <span>Volver a Responder</span>
    </button>
  </div>
  
  <!-- Mensajes de notificación -->
  <div class="mensaje-container" *ngIf="mensaje.show" [class.success]="mensaje.type === 'success'" [class.error]="mensaje.type === 'error'">
    <i class="fas" [class.fa-check-circle]="mensaje.type === 'success'" [class.fa-exclamation-circle]="mensaje.type === 'error'"></i>
    <span>{{ mensaje.text }}</span>
  </div>
  
  <!-- Indicador de carga -->
  <div class="overlay-loading" *ngIf="loading">
    <div class="loader"></div>
  </div>
  
  <!-- Mensaje cuando el cuestionario está completado -->
  <div class="evaluacion-completada" *ngIf="todosCompletados">
    <div class="icon-container">
      <i class="fas fa-check"></i>
    </div>
    <h2>¡Evaluación completada!</h2>
    <p>Has completado exitosamente el cuestionario de evaluación de factores de riesgo psicosocial.</p>
    <p>Tus respuestas han sido guardadas y serán analizadas por nuestro equipo.</p>
    <button class="btn-primary" (click)="verResultados()">
      <i class="fas fa-chart-bar"></i> Ver Resultados
    </button>
  </div>
  
  <!-- Contenido del cuestionario (visible solo si no está completado) -->
  <div class="cuestionario-content" *ngIf="!todosCompletados">
    <div class="cuestionario-panel scroll-container">
      <div class="cuestionario-header">
        <h2>Evaluación de los Factores de Riesgo Psicosocial</h2>
        <p class="description">Identifique los factores de riesgo psicosocial presentes en su entorno laboral.</p>
      </div>
      
      <div class="instruction-panel">
        <div class="icon">
          <i class="fas fa-info-circle"></i>
        </div>
        <div class="text">
          <h3>Instrucciones:</h3>
          <p>Marque la frecuencia con la que experimenta las siguientes situaciones en su entorno laboral.</p>
          <p class="scale-info">Escala de respuestas: Nunca (1), Casi Nunca (2), A Veces (3), Casi Siempre (4), Siempre (5)</p>
        </div>
      </div>
      
      <div class="questions-container">
        <div class="question-item" *ngFor="let pregunta of cuestionarios.factores; let i = index">
          <div class="question-number" [class.answered]="tieneRespuesta('factores', i)">
            {{i + 1}}
            <i *ngIf="tieneRespuesta('factores', i)" class="fas fa-check"></i>
          </div>
          <div class="question-text">
            <p>{{pregunta}}</p>
            <div class="likert-scale">
              <label 
                *ngFor="let valor of [1, 2, 3, 4, 5]; let v = index" 
                class="scale-option"
                [class.selected]="respuestas.factores[i] === valor.toString()">
                <input 
                  type="radio" 
                  name="factor_{{i}}" 
                  [value]="valor"
                  [checked]="respuestas.factores[i] === valor.toString()"
                  (change)="responderPregunta('factores', i, valor.toString())">
                <span>{{valor}}</span>
                <small>{{ v === 0 ? 'Nunca' : v === 1 ? 'Casi Nunca' : v === 2 ? 'A Veces' : v === 3 ? 'Casi Siempre' : 'Siempre' }}</small>
              </label>
            </div>
          </div>
        </div>
      </div>
      
      <div class="actions-panel">
        <div class="progress-info">
          <div class="progress-label">
            <span>{{ cuestionariosEstado.factores.respondidas }} de {{ cuestionariosEstado.factores.total }} preguntas respondidas</span>
          </div>
          <div class="progress-bar-container">
            <div class="progress-bar" [style.width.%]="calcularProgreso('factores')"></div>
          </div>
        </div>
        <div class="buttons-container">
          <button 
            class="btn-primary" 
            [class.disabled]="!todasRespondidas()" 
            [disabled]="!todasRespondidas() || loading"
            (click)="finalizarCuestionario()">
            <i class="fas fa-check-circle"></i> Finalizar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
